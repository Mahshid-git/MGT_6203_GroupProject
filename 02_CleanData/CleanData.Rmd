---
title: "CleanData"
author: "MJ"
date: "24/03/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Remove previous data from environment
rm(list = ls())
```

```{r}
library(arrow) # needed to read parquet file
```


## Read & View the Data
```{r}
# path to the project folder
#setwd("C:/Users/mjafarpour/Downloads/MGT_6203_GroupProject/")
file_path <- "../01_RawData/nfip_Houston_flood_policies.parquet"
policy_df <- read_parquet(file_path, as_tibble = TRUE)
head(policy_df)
```

## 
```{}

```

```{r}

policy_df$postfirmconstructionindicator=ifelse(policy_df$postfirmconstructionindicator=='Y',1,0)
policy_df$primaryresidenceindicator=ifelse(policy_df$primaryresidenceindicator=='Y',1,0)
policy_df$elevatedbuildingindicator=ifelse(policy_df$elevatedbuildingindicator=='Y',1,0)
policy_df$construction=ifelse(policy_df$construction=='Y',1,0)

#condominum indicator for lower level and upper level condo
policy_df$lowerlevelcondo=ifelse(policy_df$condominiumindicator=='L',1,0)
policy_df$upperlevelcondo=ifelse(policy_df$condominiumindicator=='U',1,0)

#trying to factor the locationofcontents column ....feel free to advise anyother column names. 
policy_df$lowerflooronly=ifelse(policy_df$locationofcontents=='Lowest floor only above ground level (No basement/enclosure/crawlspace/subgrade crawlspace)',1,0)

policy_df$upperandlowerfloors=ifelse(policy_df$locationofcontents=='Lowest floor above ground level and higher floors (No basement/enclosure/crawlspace/subgrade crawlspace)',1,0)

policy_df$basement=ifelse(policy_df$locationofcontents=='Basement/Enclosure/Crawlspace/Subgrade Crawlspace and above',1,0)


